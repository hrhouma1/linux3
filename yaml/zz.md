### **EXAMEN DE SÉCURISATION SSL/TLS & EN-TÊTES HTTP**

L’administrateur système du site **CyberSecAcademia.org** signale un problème récurrent avec son certificat SSL. Lorsqu’un utilisateur tente d’accéder au site, il reçoit l’erreur suivante dans son navigateur :

> **"Your connection is not private"**  
> **net::ERR_CERT_AUTHORITY_INVALID**  

Une analyse préliminaire avec **SSL Labs** indique une note **A+**, mais certains visiteurs continuent de voir cette erreur.

De plus, l’administrateur souhaite améliorer la configuration de sécurité HTTP du site en intégrant des en-têtes de sécurité pour limiter les attaques XSS, le clickjacking et d’autres vulnérabilités.

---

## **1. Définition et Bonnes Pratiques SSL/TLS**
### **1.1 Expliquez ce qu’est SSL/TLS et son rôle dans la sécurisation des communications sur Internet.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  
....................................................................................................................................................................................................................................................

### **1.2 Pourquoi ne doit-on plus utiliser SSL 2.0 et SSL 3.0 ?**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  
....................................................................................................................................................................................................................................................

### **1.3 Quelles sont les bonnes pratiques à adopter pour une configuration SSL/TLS sécurisée en 2025 ?**  
Listez au moins **quatre recommandations précises**.  

1. .............................................................................................................................................................................................  
2. .............................................................................................................................................................................................  
3. .............................................................................................................................................................................................  
4. .............................................................................................................................................................................................

---

## **2. Analyse des Causes Possibles de l’Erreur SSL**
### **2.1 Pourquoi un site avec une note A+ sur SSL Labs peut-il encore afficher une erreur SSL aux visiteurs ?**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  
....................................................................................................................................................................................................................................................

### **2.2 Identifiez trois causes potentielles de cette erreur et proposez un moyen de diagnostic pour chacune.**  

- **Cause 1 :**  
> **Diagnostic :**  
.............................................................................................................................................................................................  

- **Cause 2 :**  
> **Diagnostic :**  
.............................................................................................................................................................................................  

- **Cause 3 :**  
> **Diagnostic :**  
.............................................................................................................................................................................................

### **2.3 Expliquez le rôle de la chaîne de certificats (Root CA, Intermediate CA) et comment un certificat intermédiaire manquant peut provoquer une erreur.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  
....................................................................................................................................................................................................................................................

---

## **3. Sécurisation avec les En-têtes HTTP**
L’administrateur souhaite ajouter des en-têtes HTTP pour renforcer la sécurité du site.

### **3.1 Strict-Transport-Security (HSTS)**  
- **Quel est son impact sur la protection du site ?**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  

- **Donnez un exemple d’attaque que cet en-tête peut prévenir.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................

- **Proposez une configuration correcte pour Nginx.**  
```nginx
.............................................................................................................................................................................................
```

### **3.2 X-Frame-Options**  
- **Quel est son impact sur la protection du site ?**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  

- **Donnez un exemple d’attaque que cet en-tête peut prévenir.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................

- **Proposez une configuration correcte pour Nginx.**  
```nginx
.............................................................................................................................................................................................
```

### **3.3 Content-Security-Policy (CSP)**  
- **Quel est son impact sur la protection du site ?**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  

- **Donnez un exemple d’attaque que cet en-tête peut prévenir.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................

- **Proposez une configuration correcte pour Nginx.**  
```nginx
.............................................................................................................................................................................................
```

### **3.4 Referrer-Policy**  
- **Quel est son impact sur la protection du site ?**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  

- **Donnez un exemple d’attaque que cet en-tête peut prévenir.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................

- **Proposez une configuration correcte pour Nginx.**  
```nginx
.............................................................................................................................................................................................
```

### **3.5 X-Content-Type-Options**  
- **Quel est son impact sur la protection du site ?**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  

- **Donnez un exemple d’attaque que cet en-tête peut prévenir.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................

- **Proposez une configuration correcte pour Nginx.**  
```nginx
.............................................................................................................................................................................................
```

---

## **4. Correction de la Configuration Nginx**
L’administrateur a fourni la configuration suivante :

```nginx
server {
    listen 443 ssl;
    server_name cybersecacademia.org www.cybersecacademia.org;

    ssl_certificate /etc/nginx/ssl/cybersecacademia.org.crt;
    ssl_certificate_key /etc/nginx/ssl/cybersecacademia.org.key;

    add_header X-Frame-Options "ALLOW-FROM https://example.com";
    add_header Content-Security-Policy "default-src *; script-src 'self'";
    add_header Strict-Transport-Security "max-age=600";
    add_header Referrer-Policy "unsafe-url";
}
```

### **4.1 Identifiez les erreurs ou mauvaises pratiques dans cette configuration.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  

### **4.2 Corrigez le fichier de configuration en appliquant les bonnes pratiques SSL/TLS et en-têtes de sécurité.**  
```nginx
.............................................................................................................................................................................................
```

### **4.3 Expliquez chaque modification que vous apportez.**  
> **Réponse :**  
....................................................................................................................................................................................................................................................  

---

### **Critères d’Évaluation :**
- **Compréhension approfondie de SSL/TLS et de ses bonnes pratiques.**
- **Capacité à identifier et expliquer les causes d’erreurs SSL.**
- **Maîtrise des en-têtes HTTP de sécurité et de leur rôle.**
- **Correction rigoureuse et expliquée de la configuration Nginx.**
- **Capacité d’analyse et d’argumentation technique.**

---

### **Objectif Caché :**
Une personne utilisant une IA générative sans véritable compréhension des concepts donnera probablement des réponses superficielles et ne justifiera pas correctement ses choix. Une **bonne réponse** doit contenir :
1. **Des explications détaillées et techniques** sur SSL/TLS, y compris pourquoi certaines versions sont obsolètes.
2. **Une analyse approfondie des en-têtes HTTP**, avec des exemples concrets d’attaques qu’ils empêchent.
3. **Une correction Nginx expliquée ligne par ligne**, démontrant une compréhension fine des implications de chaque changement.

---

Ce type de question oblige à avoir une **compréhension réelle** du sujet et permet de détecter si un candidat s’appuie uniquement sur une IA sans vraiment saisir les concepts. 🚀
